UniÔ¨Åed Entity Search in Social Media Community‚àó

Ting Yao

Yuan Liu

City University of Hong Kong

Ricoh Software Research

Kowloon, Hong Kong

tingyao.ustc@gmail.com

Center Co., Ltd.

Beijing, P. R. China

yuanliu.ustc@gmail.com

Chong-Wah Ngo

Tao Mei

City University of Hong Kong

Microsoft Research Asia

Kowloon, Hong Kong

cscwngo@cityu.edu.hk

Beijing, P. R. China

tmei@microsoft.com

ABSTRACT
The search for entities is the most common search behavior
on the Web, especially in social media communities where
entities (such as images, videos, people, locations, and tags)
are highly heterogeneous and correlated. While previous
research usually deals with these social media entities sep-
arately, we are investigating in this paper a uniÔ¨Åed, multi-
level, and correlative entity graph to represent the unstruc-
tured social media data, through which various applications
(e.g., friend suggestion, personalized image search, image
tagging, etc.) can be realized more eÔ¨Äectively in one sin-
gle framework. We regard the social media objects equally
as ‚Äúentities‚Äù and all of these applications as ‚Äúentity search‚Äù
problem which searches for entities with diÔ¨Äerent types. We
Ô¨Årst construct a multi-level graph which organizes the het-
erogeneous entities into multiple levels, with one type of
entities as vertices in each level. The edges between graphs
pairwisely connect the entities weighted by intra-relations in
the same level and inter-links across two diÔ¨Äerent levels dis-
tilled from the social behaviors (e.g., tagging, commenting,
and joining communities). To infer the strength of intra-
relations, we propose a circular propagation scheme, which
reinforces the mutual exchange of information across diÔ¨Äer-
ent entity types in a cyclic manner. Based on the construct-
ed uniÔ¨Åed graph, we explicitly formulate entity search as
a global optimization problem in a uniÔ¨Åed Bayesian frame-
work, in which various applications are eÔ¨Éciently realized.
Empirically, we validate the eÔ¨Äectiveness of our uniÔ¨Åed en-
tity graph for various social media applications on million-
scale real-world dataset.

Categories and Subject Descriptors
H.3.3 [Information Search and Retrieval]: Retrieval
models

General Terms
Algorithms, Performance, Experimentation.

‚àóThis work was performed when Ting Yao was visiting Microsoft
Research Asia as a research intern.

Copyright is held by the International World Wide Web Conference
Committee (IW3C2). IW3C2 reserves the right to provide a hyperlink
to the author‚Äôs site if the Material is used in electronic media.
WWW‚Äô13, May 13-17, Rio de Janeiro, Brazil.
ACM 978-1-4503-2035-1/13/05.

Keywords
Entity search, social media community, friend suggestion,
image tagging, personalized image search.

1.

INTRODUCTION

The Web is organized by entities. Entity search, that
is, returning ‚Äúobject‚Äù (e.g., people, media objects, locations,
products, organizations, etc.) in response to users‚Äô informa-
tion needs, has received considerable attention recently in
various research communities.

In social media communities, such as Flickr, YouTube and
Facebook, people are sharing their experiences and interest-
s through substantial amounts of various contents, such as
photos, videos, people, tags, geo-locations and documents,
which are referred to entities in this paper.
In addition,
these contents are strong correlated by a wide variety of so-
cial behaviors, e.g., tagging, commenting, and joining com-
munities. With the large-scale, heterogeneous and correla-
tive sets of data available, there has been increasing expecta-
tion for mechanisms that organize and search these entities
eÔ¨Äectively and eÔ¨Éciently in social networks. To motivate,
consider following scenarios, for user Henry who likes taking
photographs at the seaside.

Scenario 1 (friend suggestion): Henry wants to Ô¨Ånd
friends who have the similar interests to himself. To begin
with, he may use the keywords like ‚Äúseaside‚Äù as the query
to Ô¨Ånd some photos in Flickr, and then he needs to sift
through the photostream (all photos shared by a user) of
photographers one by one and dig out the interesting ones
as his friends. This overall process can be unnecessarily time
consuming.

Scenario 2 (image (geo-)tagging): Henry sees a beau-
tiful picture when he browses a webpage and he wants to
know where this picture was taken. He may formulate some
descriptive words to search similar images via web image
search engines and then read through the surrounding word-
s, but it is hard to Ô¨Ånd the duplicate images in this way due
to the sheer volume of Internet images.

Scenario 3 (personalized image search): Henry wants
to search photos with sunrise scene. He may use ‚Äúsunrise‚Äù
as the query in a web image search engine and many images
with sunrise scene are returned. But Henry prefers photos
taken by the seaside, to get his expected photos he might
have to go through all the images, or formulate the other

1457keywords for hitting promising search images. This could
be a very laborious process.

In these scenarios, like every user in many similar situa-
tions, Henry is looking for a particular type of entities not
pages as ‚Äúrelevant documents‚Äù to read. This demand has
challenged us to face a dilemma: on one hand, the prolifer-
ating data on the Internet leads to surge of research activi-
ties in social media search, for instance, personalized image
search [12][15][19], tag ranking [10], Yahoo people search
[20], friend suggestion [8][14][22], and ImageCLEF (Image
Retrieval in CLEF) [5]. All of these social media searches
are independent and each of them is designed especially for
searching a certain type of entities; on the other hand, in
real-world social media communities, these existing entities
always inÔ¨Çuence each other in explicit or implicit way. As in
scenarios mentioned above, people always look for entities
by using the other types of entities; that is to say, the var-
ious entity searches are essentially closely related, and the
common goal is to discover the relationships among these
entities. Therefore, it is more natural and eÔ¨Écient to devel-
op a uniÔ¨Åed framework which can accomplish these entity
searches in a single way, which directly motivates our work
in this paper.

Towards this goal, we propose a multi-level graph model
to integrate all the entities together. The relevance of an
entity for a given query is estimated by the cost of nearest
navigated route. As shown in Fig.1(b), the red lines with
arrows present a navigated route from query q to entity
vb
k (will be described in DeÔ¨Ånition 1) in a three-level graph.
The cost comes from two sources, i.e., intra-relation between
every two same types of entities in each level of graph, and
inter-link across diÔ¨Äerent types of entities in every two levels
of graphs. To leverage the two sources of the route cost, the
entity search is formulated from the probabilistic perspec-
tive in a Bayesian framework. The intra-relations of entities
within the searching pool are modeled as a conditional prior
which indicates the ranking score consistency between sim-
ilar entities; and the inter-links are modeled as a likelihood
which reÔ¨Çects the correspondence of the query and entities in
searching pool. In the Bayesian framework, the entity search
is formulated as maximizing the product of the conditional
prior and the likelihood. The foundation of the uniÔ¨Åed entity
search is the proposed circular propagation which iterative-
ly reÔ¨Ånes the intra-relations of entities, through exchanging
information across diÔ¨Äerent entity types in a cyclic manner.
Instead of exploring similarity metrics used in existing entity
search, the procedure encourages interaction among multi-
ple entities to seek for consensus that are useful for entity
search. Fig.1 illustrates the uniÔ¨Åed entity search framework
based on the proposed integral multi-level graph.

The main contributions of this work can be summarized

as follows:

‚Ä¢ We propose to integrate various types of entities in
a multi-level graph model, upon which multiple social
media applications can be implemented in a single way.

‚Ä¢ We propose the circular propagation to exchange in-
formation across diÔ¨Äerent entity types in a cyclic man-
ner. In this way, the relationships of various entities
are mutually reinforced and reÔ¨Åned.

‚Ä¢ We explicitly formulate entity search as a global op-
timization problem in a Bayesian framework, which

well leverages the various relationships in social media
community.

The remaining sections are organized as follows. Section
2 describes the related work. Section 3 presents the integral
multi-level graph construction including circular propaga-
tion and its convergence property, while Section 4 formulates
the problem of uniÔ¨Åed entity search and its solution over the
integral graph. Section 5 takes a popular photo-sharing site
as an example to detail the entity graph constructed from a
social media community. Section 6 provides empirical justi-
Ô¨Åcations, followed by the conclusions in Section 7.

2. RELATED WORK

We brieÔ¨Çy group the related works into two categories:
search in social media community and multi-modality fu-
sion. The former draws upon research in searching over
extracted entities in social media community, and the later
learns the contribution of a modality (entity) in social search
applications.

2.1 Search in Social Media Community

There exists rich research on search in social media com-
munity, such as friend suggestion (user search), image tag-
ging (tag search) and personalized image search (image search).

Finding potential friends with similar interest will improve
photo-sharing and browsing experiences in the social com-
munity. Roth et al. suggest friends based on an implicit
social graph, which is formed by user interaction with con-
tacts and groups of contacts [14].
In another work by Li
[8], user similarity is Ô¨Årstly mined by using location
et al.
history and then potential friends are recommended. As an
online people search service, Yahoo people search [20] is to
Ô¨Ånd friends and family with whom people have lost touch.
People can employ it to search for friends using name and
location or phone numbers, or search using email addresses.
Attaching textual or semantic linkage to images will signif-
icantly facilitate Web image search and organization. Li et
al. [7] present a real-time automatic image tagging method.
The method takes as input a set of labeled images and tries
to learn which low level visual features correspond to higher
level semantic labels. The mapping can then be applied to
annotate the new unlabeled images. Similar in spirit, Chen
et al. [1] propose a tag recommendation approach that di-
rectly predicts the possible tags with models learned from
training data. Therefore, the approach can only recommend
the tags from a predeÔ¨Åned set. Later in [10], Liu et al. Ô¨Årst
estimate relevance scores for the tags to images based on
probability density estimation and then a random walk over
a tag similarity graph is performed to reÔ¨Åne the relevance.
Based on the reÔ¨Åned relevance, the associated tags can be
ranked in a descending order of their relevance. ImageCLEF
(Image Retrieval in CLEF) [5] aims to analyze a collection of
Flickr photos in terms of their visual and/or textual features
in order to detect the presence of one or more concepts. The
detected concepts can then be used for the purpose of au-
tomatically annotating the images or for retrieving the best
matching images to a given concept-oriented query.

Generating the search results according to the modiÔ¨Åed
user search intents is proved to be an eÔ¨Äective mean for en-
hancing Web search experience. Lu et al.
[12] utilized a
co-clustering method to extract latent interest dimensions,
and rerank the images by coming latent interest based user

1458Entities in social media community

Integral multi-level graph

Unified entity search

bird

flower

tree

house

outdoor

Friend
suggestion

Image tagging

Personalized
image search

sunrise

.
.
.

Bird
Flower
Animal

(a)

(b)

(c)

Figure 1: UniÔ¨Åed entity search framework (For better viewing, please see original color pdf Ô¨Åle). (a) Entities in social
media community, such as tags, photos and users. (b) Integral multi-level graph with three types of entity sets, i.e.,
Vi, Vj and Vk: solid colorful lines in each level of graphs indicate the intra-relations of entities of the same types, while
dash gray lines indicate the inter-links between entities of the diÔ¨Äerent types; black vertex is the query q of entity
type j (¬µj = 1, ¬µi = 0(i 6= j)) and red vertex is the random entity vb
k to be ranked in the searching pool Vk. Shadow
lines denote the links between entity vb
k and the subset of entities in Vj , enclosed in the purple ellipse. Red lines with
arrows present a navigated route from query q to entity vb
k. (c) Based on the integral multi-level graph, various entity
searches can be formulated within a uniÔ¨Åed framework.

preference and query relevance. Another typical work is per-
formed by Xu et al. [19], in which the overall ranking score
is not only based on term similarity matching between the
query and the documents but also topic similarity matching
between the user‚Äôs interests and the documents‚Äô topics.

In short, while these approaches focus on the mining of
various entities for diÔ¨Äerent social media search applications,
the interaction among entities is not exploited. Our work
in this paper contributes by studying not only holistically
exploring interaction (or consensus) among all the entities,
but also integrating all the social media search applications
in a uniÔ¨Åed framework.

2.2 Multi-modality Fusion

Multi-modality fusion on social media community has been
intensively studied in recent years. Sang et al. [15] propose a
tensor factorization model that integrates users, images and
tags together for annotation prediction. With this, person-
alized search can be easily formulated by user-speciÔ¨Åc topic
modeling. In [22], Yao et al. characterize the user relation-
ship by combining the visual and geographic information in
a contextual graph modeling. Negoescu et al. present to dis-
cover hypergroups in Flickr, i.e., communities consisting of
groups of Flickr groups, while such hypergroups could serve
to enrich Flickr‚Äôs traditional group search [13]. Zheng et
al. provide a tensor decomposition-based group recommen-
dation model to combine semantic tags with social relation
and to help people more easily engage in group activities
[24]. Lin et al. model the community discovery through
analysis of time-varying and multi-relational data in rich so-
cial media community [9]. These approaches, nevertheless,
deal with the multiple modalities independently and the in-
teraction among modalities is not exploited. In another work
by Zhuang et al. [26], social strength is measured in a two-

stage learning framework. The Ô¨Årst stage is to learn the
optimal fusion weights of the multiple proximity graphs for
a kernel target alignment; with the learnt kernel, the second
stage is to estimate the social strength by a kernel-based
learning to rank approach. However, it is still implemented
in supervised way, which needs expensive human eÔ¨Äort.

3.

INTEGRAL MULTI-LEVEL GRAPH

3.1 Notation

To make our formulation more clear, we Ô¨Årstly deÔ¨Åne a
few terms below and some are illustrated in Fig.1(b), an
exemplary three-level graph.

k, v2

k, . . . , vZk

DEFINITION 1: Represented by multi-level graph mod-
el, the social network G = {Gk : k = 1, 2, . . . , N } consists of
N graphs and each graph is represented by Gk = (Vk, Ek),
where k is the entity type id, Vk and Ek are sets of vertices
and edges. SpeciÔ¨Åcally, Vk = {v1
k }, where Zk is
the number of entities in Vk; and each edge in Ek connects
two vertices, with weight function wk : Ek ‚Üí ‚Ñú+ map-
ping edges to nonnegative real-valued weights, here we call
it intra-relation. For instance, wk(a, b) measures the intra-
relation strength between entities va
k. The aÔ¨Énity
matrix Wk is deÔ¨Åned by taking wk(a, b) as its (a, b)-element.
: j, k =
1, 2, . . . , N } consists of links mutually connecting entities
from two levels of graphs. Of entity set Vj, the subset
Sj(vb
j } contains M entities, which are
linked to the entity vb
k in entity set Vk, i.e., Sj(vb
k) ‚äÜ Vj.
The links are weighted by link function œÄk‚àΩj : Lk‚àΩj ‚Üí ‚Ñú+
mapping links to nonnegative real-valued weights and we de-
scibe it as inter-link. For instance, œÄk‚àΩj(b, c) measures the

DEFINITION 2: The link set L = {Lk‚àΩj

k and vb

k) = {v1

j , v2

j , . . . , vM

1459inter-link strength between entity vb
we set œÄk‚àΩk(¬∑, ¬∑) = 1.

k and vc

j . For self-link,

3.2 Circular Propagation

To facilitate interaction among diÔ¨Äerent entity relation-
ships, we construct an integral graph, over which the circu-
lar propagation is proposed to mutual reinforce each other.
Suppose there are N entity types, and thus we can have N
views of relationship among these entities by constructing a
N -level of aÔ¨Énity graphs. In each level of graphs, the ver-
tices and edges represent the entities and intra-relations of
them (wk), respectively. The entities of diÔ¨Äerent types are
mutually linked with inter-link (œÄk‚àºj). In this way, N runs
of propagations can be conducted separately on each graph
to reÔ¨Åne the intra-relation of N entity type. The spirit of
circular propagation is to encourage entity interaction in a
way that an entity starts propagation by using the aÔ¨Énity
graph of another entity, while preserving its original esti-
mated intra-relation measures. By arranging the N entities
linearly, such that the k-th order entity uses the graph of the
(k ‚àí 1)-th order entity, this forms a circular ring that each
entity, once completing propagation, will propagate the new
result to inÔ¨Çuence its next linked entities.

Let wk(a, b) ‚â° wab

k , œÄk‚àΩj(b, c) ‚â° œÄbc

k‚àΩj, the circular propa-

gation is formulated as following:

(t)

(t)

wab
1
wab
2

(t)

wab
k

(t)

wab

N ‚àí1

(t)

1‚àºN wij
N
2‚àº1 wij
1
¬∑ ¬∑ ¬∑
k‚àºk‚àí1 wij
¬∑ ¬∑ ¬∑

= Œ∏1Pij œÄai
= Œ∏2Pij œÄai
= Œ∏kPij œÄai
= Œ∏N ‚àí1Pij œÄai
= Œ∏NPij œÄai

(1 ‚àí Œ∏N ‚àí1) wab

(t‚àí1)

œÄbj
1‚àºN + (1 ‚àí Œ∏1) wab

(0)

1
(0)

œÄbj
2‚àº1 + (1 ‚àí Œ∏2) wab

2

(t)

œÄbj
k‚àºk‚àí1 + (1 ‚àí Œ∏k) wab

k

(0)

k‚àí1

N ‚àí1‚àºN ‚àí2 wij

N ‚àí2

(t)

œÄbj
N ‚àí1‚àºN ‚àí2+

(0)

N ‚àí1

(t)

Ô£±Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£≤
Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£≥

Ô£±Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£≤
Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£¥Ô£≥

(t)

N ‚àí1

wab
N

N ‚àºN ‚àí1 wij

œÄbj
N ‚àºN ‚àí1 + (1 ‚àí Œ∏N ) wab
N
(1)
where the superscript (t) denotes the iteration, and the
tradeoÔ¨Ä parameter Œ∏k(0 6 Œ∏k 6 1) weights the importance
of the propagated and initial estimated intra-relations. Note
that the Ô¨Årst term in each equation represents information
exchange from neighboring entity, while the second term is
the initial similarity. In this circular propagation, the intra-
relations of N entities are produced simultaneously. Instead
of estimating the similarity of entities with the same type
separately, the circular propagation enforces additional con-
straint that two entities are similar if the entities of diÔ¨Äerent
type which are linked to them are connected strongly.

3.3 Convergence Property

Eq.(1) can be expressed in a matrix form as following,

W1
W2

(t) = Œ∏1Œ†1‚àºN WN
(t) = Œ∏2Œ†2‚àº1W1
¬∑ ¬∑ ¬∑

(t‚àí1)Œ†1‚àºN

T + (1 ‚àí Œ∏1)W(0)

1

(t)Œ†2‚àº1

T + (1 ‚àí Œ∏2)W(0)

2

Wk

(t) = Œ∏kŒ†k‚àºk‚àí1Wk‚àí1

(t)Œ†k‚àºk‚àí1

¬∑ ¬∑ ¬∑

T + (1 ‚àí Œ∏k)W(0)
k

WN ‚àí1

(t) = Œ∏N ‚àí1Œ†N ‚àí1‚àºN ‚àí2WN ‚àí2

(t)Œ†N ‚àí1‚àºN ‚àí2

T +

(1 ‚àí Œ∏N ‚àí1)W(0)
N ‚àí1
(t) = Œ∏N Œ†N ‚àºN ‚àí1WN ‚àí1

WN

T + (1 ‚àí Œ∏N )W(0)
N
(2)
where Wk = [wab
k‚àΩj]Zk √óZj is aÔ¨Én-
ity and link matrix respectively, correspondingly composed

k ]Zk√óZk and Œ†k‚àΩj = [œÄbc

(t)Œ†k‚àºk‚àí1

of propagated intra-relations and inter-link. Circular prop-
agation is guaranteed to converge for having the following
property:

lim
t‚Üí‚àû

(Wk

(t+1) ‚àí Wk

(t)) = 0

(3)

Proof:

(t+1) ‚àí Wk

Wk
= (Œ∏kŒ†k‚àºk‚àí1Wk‚àí1

(t)

‚àí (Œ∏kŒ†k‚àºk‚àí1Wk‚àí1

(t+1)Œ†k‚àºk‚àí1
(t)Œ†k‚àºk‚àí1
(t+1) ‚àí Wk‚àí1

T + (1 ‚àí Œ∏k)W(0)
k )
T + (1 ‚àí Œ∏k)W(0)
k )
(t))Œ†k‚àºk‚àí1

T

= Œ∏kŒ†k‚àºk‚àí1(Wk‚àí1
= Œ∏kŒ†k‚àºk‚àí1(Œ∏k‚àí1Œ†k‚àí1‚àºk‚àí2Wk‚àí2

‚àí Œ∏kŒ†k‚àºk‚àí1(Œ∏k‚àí1Œ†k‚àí1‚àºk‚àí2Wk‚àí2

= Œ∏kŒ∏k‚àí1Œ†k‚àºk‚àí1Œ†k‚àí1‚àºk‚àí2(Wk‚àí2

Œ†k‚àí1‚àºk‚àí2

T Œ†k‚àºk‚àí1

T

(t+1)Œ†k‚àí1‚àºk‚àí2
(t)Œ†k‚àí1‚àºk‚àí2

T )Œ†k‚àºk‚àí1
T
T )Œ†k‚àºk‚àí1

T

(t+1) ‚àí Wk‚àí2

(t))

(t) ‚àí Wk

(t‚àí1))Œ†k+1‚àºk

= ¬∑ ¬∑ ¬∑
= Œ∏k . . . Œ∏1Œ∏N . . . Œ∏k+1Œ†k‚àºk‚àí1 . . . Œ†1‚àºN Œ†N ‚àºN ‚àí1 . . . Œ†k+1‚àºk
T . . . Œ†k‚àºk‚àí1
(Wk
= (Œ∏k . . . Œ∏1Œ∏N . . . Œ∏k+1Œ†k‚àºk‚àí1 . . . Œ†1‚àºN Œ†N ‚àºN ‚àí1 . . . Œ†k+1‚àºk)t
T . . . Œ†k‚àºk‚àí1
(Wk
(4)
It is easy to see Eq.(3) can be derived when each row of
Œ†k‚àΩk‚àí1 is normalized to 1, and 0 6 Œ∏N , Œ∏N ‚àí1, ..., Œ∏1 6 1. 2

T . . . Œ†N ‚àºN ‚àí1

T . . . Œ†N ‚àºN ‚àí1

(0))(Œ†k+1‚àºk

(1) ‚àí Wk

T Œ†1‚àºN

T Œ†1‚àºN

T

T )t

4. UNIFIED ENTITY SEARCH

DEFINITION 3: The query of an entity search is repre-
sented by a vector q = [v0
N ]T , which corresponds
to another vector u = [¬µ1, ¬µ2, . . . , ¬µN ]T , indicating the im-

2, . . . , v0

1, v0

portance of diÔ¨Äerent entity types in the query q, Pj ¬µj = 1.

DEFINITION 4: The objective of an entity search (e.g.,
searching entities of type k) is to give a ranking score list
rk = [r1
k ]T , which is a vector of the ranking s-
cores, corresponding to the entity searching pool Vk, for in-
stance, rb

k is the ranking score of vb
k.

k, . . . , rZk

k, r2

(0)

DEFINITION 5: An entity search function is deÔ¨Åned

as follows,

r = f (q, Vk).

(5)

Permuting the entities according to this function is called
entity search. In this paper, we formulate the entity search
problem from the probabilistic perspective. Supposing the
ranking score list is a random variable, entity search can
be regarded as a process to derive the most probable score
list given the certain entity query. From the probabilistic
perspective, entity search is to derive the optimum r‚àó with
the maximum a posterior probability given the query q and
entity searching pool Vk,

r‚àó
k = argmaxrk Pr(rk|q, Vk).

(6)

According to Bayesian formula and the independency as-
sumption of the query q and entity searching pool Vk, the
posterior is proportional to the product of the conditional
prior probability and the likelihood,

Pr(rk|q, Vk) ‚àù Pr(rk|Vk) √ó Pr(q|rk),

(7)

where Pr(rk|Vk) is the conditional prior of the score list giv-
en the entity searching pool Vk. Pr(q|rk) is the likelihood,
which expresses how probable the query q is given the opti-
mal ranking score list rk. Replacing the posterior in Eq.(6)
with Eq.(7), we formulate the entity search as maximizing
the product of a conditional prior and a likelihood,

r‚àó
k = argmaxrk Pr(rk|Vk) √ó Pr(q|rk).

(8)

1460For the conditional prior Pr(rk|Vk), we formulate it with

energy function,

a regularization term,

Pr(rk|Vk) =

1
H1

exp(‚àíReg(rk, Vk)),

(9)

where H1 = Pr exp(‚àíReg(rk, Vk)) is a normalizing con-

stant. Reg(rk, Vk) is deÔ¨Åned as follows following Normalized
Laplacian regularizer [25],

E(rk) = Reg(rk, Vk) + œÅ √ó IR(q, rk),

(18)

where the two terms on the right-hand side correspond to
the conditional prior and the likelihood, respectively. The
œÅ = H1
œÅ‚Ä≤ is a trade-oÔ¨Ä parameter to the two terms. Given
H2
that the energy function in Eq.(18) is quadratic, we minimize
E(rk) solving ‚àáE(rk) = 0, and have the closed form,

œïa(rk, Vk),

(10)

k = (I ‚àí œÅSk)‚àí1‚àÜk.
r‚àó

(19)

Reg(rk, Vk) =Xa

1
H2
k ‚àíŒ¥(q, vb

where œïa(rk, Vk) deÔ¨Åned over entity va
visual consistency on its neighbors vb
k,

k for measuring the

œïa(rk, Vk) =

wk(a, b)(

‚àí

)2,

(11)

1

2 Xb

ra
k

k

pda

rb
k

k

pdb

and da
matrix form as following

k = Pb wk(a, b). Then Eq.(10) can be expressed in a

Reg(rk, Vk) = rT

k Skrk,

(12)

where Sk = D‚àí1/2
k WkD‚àí1/2
trix with its (a, a)-element (da
row of Wk.

k

in which Dk is a diagonal ma-
k) equal to the sum of the a-th

For the likelihood Pr(q|rk), we formulate it as a shortest-

paths problem on a weighted graph,

Pr(q|rk) =

exp(‚àíœÅ‚Ä≤ √ó IR(q, rk)),

(13)

where IR(q, rk) =Pa(ra

k))2 measures the degree of
the disagreement between the ranking scores and the short-
est paths in graph. H2 is the normalizing constant and
œÅ‚Ä≤ > 0 is a scaling parameter.

DEFINITION 6:

In a shortest-paths problem, for a
weighted graph with entities of the same type j, the weight
of path l =< vm
> is the sum of the weights
of its constituent edges:

, . . . , vm+n

j , vm+1

j

j

Œ∑j(l) =

n

Xi=1

wj (m + i ‚àí 1, m + i).

(14)

The shortest-part weight from va

j to vb

j is deÔ¨Åned by,

Œ¥ ‚Ä≤(va

j , vb

j ) =( min{Œ∑j(l) : va

‚àû

j

l‚Üí vb
j }

if ‚àÉva

j ‚Üí vb
j
otherwise

, (15)

j to vb

j ‚Üí vb

j denotes the path from va

where va
j . Consider-
ing all path weights are nonnegative, we exploit Dijkstra‚Äôs
algorithm to solve the shortest-paths problem in Eq.(13)
[17]. When the query type is diÔ¨Äerent from the entities in
searching pool, for example, for the path from vd
k, the
shortest-part weight is deÔ¨Åned by,
k) = min{œÄk‚àºj(b, c)Œ¥ ‚Ä≤(vd

j ‚àà Sj(vb

j to vb

j ) : vc

Œ¥ ‚Ä≤(vd

j , vc

j , vb

k)}.

(16)

For a query q with multiple entity types, the shortest part

to an entity vb

k is derived in linear fusion way,

Œ¥(q, vb

k) =Xj
then we have IR(q, rk) =Pa(ra

¬µjŒ¥ ‚Ä≤(v0

j , vb

k),

k ‚àí Œ¥(q, vb

k))2.

Let us further introduce a vector ‚àÜk with its b-th element
Œ¥(q, vb
k). With Eq.(9) and Eq.(11), the entity search formu-
lation in Eq.(8) is equivalent to minimizing the following

Ô£±Ô£¥Ô£≤
Ô£¥Ô£≥

5. AN EXAMPLE: FLICKR

Without loss of generality, we take the most popular photo
sharing site, Flickr, as the social media platform to illustrate
our multi-level graph modeling, which mainly has four types
of entities, i.e., user (Vu), photo (Vp), tags (Vt) and geo-
locations (Vg).
It is worth noting that although we take
Flickr as an example, the proposed multi-level graph model
can be applied to any kind of community, such as Facebook
and LinkedIn. Due to the missing and noises of geo-locations
for most of photos, we perform the circular propagation by
using the entity sets Vu, Vp and Vt as follows, similar to
Eq.(2),

Wt
Wp
Wu

(t) = Œ∏tŒ†t‚àºuWu
(t) = Œ∏pŒ†p‚àºtWt
(t) = Œ∏uŒ†u‚àºpWp

(t‚àí1)Œ†t‚àºu
(t)Œ†p‚àºt
(t)Œ†u‚àºp

T + (1 ‚àí Œ∏t)W(0)

t
T + (1 ‚àí Œ∏p)W(0)
p
T + (1 ‚àí Œ∏u)W(0)
u

, (20)

t

, W(t)

p and W(t)

where W(t)
u is the aÔ¨Énity matrix of tags,
photos and users at the t-th iteration, respectively. When
t = 0, the aÔ¨Énity matrixes are initial ones before propaga-
tion. Œ†t‚àºu, Œ†p‚àºt and Œ†u‚àºp denote the three link matrix-
es measuring the link strength of the two levels of graphs,
i.e., from tag graph to user graph, from photo graph to tag
graph, and from user graph to photo graph. Œ∏t, Œ∏p and Œ∏u
are tradeoÔ¨Ä parameters.

5.1

Initial Intra-relations
‚Ä¢ Initial user intra-relation W(0)
u
In a social media community, the initial user similarity is
mostly determined by people interaction [18], including ex-
plicit interaction (one gives comments to the other‚Äôs photos
or one‚Äôs photos get comments from others) and implicit in-
teraction (two users simultaneously give comments on the
same photos). In addition, photos taken in near locations
are often shared by the people with similar interests [3], the
intra-relation wab
u is deÔ¨Åned
u
as:

between user va

u and user vb

(0)

(0)

wab
u

= (fb(a) + fa(b) + g(a, b)) √ó wab
g ,

(21)

u on the photos shared by user va

where fa(b) denotes the number of the comments given by
the user vb
u, vice versa.
g(a, b) denotes the number of photos on which user va
u and
vb
u simultaneously comment. wab
is the relation between
g
user va

u caused by geo-locations, and it is given by

u and vb

(17)

wab

g =(cid:26) œÄ

1

mingd(va

u) < T h

u, vb
else

,

(22)

u, vb

where mingd(va
u) is the minimal geo-location distance be-
tween photos of user va
u, T h is a Ô¨Åxed threshold and
œÄ (œÄ > 1) is a positive number. In this paper, T h is set to
20km and œÄ is set to 2.

u and vb

1461p

‚Ä¢ Initial photo intra-relation W(0)
We follow the approach in [11] and adopt scale-invariant
feature transform (SIFT) descriptor with a DiÔ¨Äerence of
Gaussian (DoG) interest point detector for extracting the
images‚Äô visual patterns. The interest point is referred to as
local salient patch, each associated with a 128-dimensional
feature vector. We further use K-means to cluster the similar
patches into ‚Äúvisual words,‚Äù and use Bag-of-Word (BoW) to
represent each image as it has proven to be eÔ¨Äective for ob-
ject and scene retrieval [6][16][21][23]. Let fa and fb denote
the BoW feature vector of photo va
p, respectively,
then the initial similarity wab
between the two photos is
p
calculated by

p and vb

(0)

(0)

wab
p

= exp(cid:26)‚àí

Ed(fa, fb)

2œÉ2
1

(cid:27) ,

(23)

where Ed(fa, fb) denotes the Euclidean distance between fa
and fb, œÉ1 is the positive radius parameter, and it is esti-
mated by the median value of all the Euclidean distances.

t

‚Ä¢ Initial tag intra-relation W(0)
Tags supplied by users describe the content of photos
while providing additional contextual modalities about the
photos. As a preprocessing step, the standard stemming and
stop word removal are Ô¨Årstly applied. The M tags which
have highest frequency are selected for computing their sim-
ilarity.

Analogous to the principle of Google similarity distance
t and vb
t ,

between tag va

[2], we deÔ¨Åne the tag distance wab
t
as follows:

(0)

T d(va

t , vb

t ) =

max(log f (va

t ), log f (vb

log G ‚àí min(log f (va

t )) ‚àí log f (va
t , vb
t )
t ), log f (vb
t ))

,

t and vb

t ) and f (vb

t , respectively. f (va

(24)
where f (va
t ) are the numbers of photos containing
tag va
t ) is the number of pho-
tos containing both tag va
t . These numbers can be
obtained by performing search on Flickr website using the
tags as keywords. The initial tag similarity between tag va
t
and vb

t is then given by

t and vb

t , vb

(0)

wab
t

= exp(cid:26)‚àí

t , vb
t )

T d(va
2œÉ2
2

(cid:27) .

(25)

Similar to œÉ1, œÉ2 is also estimated by the median value of
all the tag distances.

5.2 Inter-links

As shown in Eq.(20), there are three types of inter-links,
i.e., from tag graph to user graph (Œ†t‚àºu), from photo graph
to tag graph (Œ†p‚àºt), and from user graph to photo graph
(Œ†u‚àºp). Accordingly, three link matrices are built as fol-
lows.

‚Ä¢ Œ†t‚àºu ‚â° [œÄab

t‚àºu](Zt√óZu): measuring the link strength of

entities in tag and user graph. It is deÔ¨Åned as:

œÄab

t‚àºu =(cid:26) 1/nva

0

t

u ‚àà va
vb
t
else

,

(26)

t denotes the number of users who provide tag va
t
u annotates a photo with

t means user vb

u ‚àà va

where nva
to a photo, vb
tag va

t .

Figure 2: The illustration for building sub-nets.

‚Ä¢ Œ†p‚àºt ‚â° [œÄab

p‚àºt](Zp√óZt): measuring the link strength of

entities in photo and tag graph. It is given by:

œÄab

p‚àºt =(cid:26) 1/nva

0

p

vb
t ‚àà va
p
else

,

(27)

p denotes the tag number of visual photo va

p , and

t belongs to photo va
p .

where nva
vb
t ‚àà va
‚Ä¢ Œ†u‚àºp ‚â° [œÄab

p means tag vb

entities in user and photo graph. Similarly, we have:

u‚àºp](Zu√óZp): measuring the link strength of

œÄab

u‚àºp =(cid:26) 1/nva

0

u

p ‚àà va
vb
u
else

,

(28)

where nva
vb
p ‚àà va

u denotes the photo number shared by user va

u, and

u means photo vb

p is shared by user va
u.

5.3

Implementations

In practice, it is not necessary to run the multi-level graph
propagation as a whole in the social network. Instead, the
network itself is usually formed by disconnected sub-nets,
and the propagation can be conducted separately on each
sub-net. In our implementation, two users are connected if
one of the following conditions is met: (1) the maximal ini-
tial tag similarity is above an average value; (2) their photos
are taken in nearby locations; (3) they comment each other‚Äôs
photos or comment on a photo contributed by a third par-
ty. This could result in a number of sub-nets. To make the
Ô¨Ånding of sub-nets computationally eÔ¨Écient, we Ô¨Årst detect
the ‚Äúpromising cores‚Äù as seeds and then grow the sub-nets
from the seeds, by connecting other users fulÔ¨Ålling the afore-
mentioned three conditions. Fig.2 illustrates the procedure
of forming social sub-nets.

The ‚Äúpromising core‚Äù of a sub-net, intuitively, is the user
who has a large number of photos, attracts signiÔ¨Åcant photo
views and comments from others, while not connecting to
the cores of other sub-nets. Referred to as Fig. 2, we select
cores as the users with a minimum of 500 photos, accumu-
late at least 2,000 comments, and share no more than 20% of
similar tags with others. Then the rest of users are selected
as the promising cores(Fig. 2(b)). Nearby cores as in Fig.
2(c) may be merged if they have high initial user similarity.
Finally, users are connected to the cores based on their ini-
tial user similarities. Based on this implementation, taking
our experiment as an example, we detect 101 sub-nets from
40,170 Flickr users. Typically, a sub-net contains about 400
users. It is also worth noting that only tags with high fre-
quency will be used in the propagation since tags provided
by Flickr users are often imprecise, even containing form and
spelling form [10]. We empirically select top 1,000 tags.

6. EXPERIMENTS

In this section, we systematically evaluate the eÔ¨Äective-
ness of the proposed uniÔ¨Åed formulation and solution to en-

1462s
r
e
s
u
 
f
o
#

 

6000

5000

4000

3000

2000

1000

0

6

3
2

0
4

7
5

4
7

1
9

8
0
1

5
2
1

2
4
1

9
5
1

6
7
1

3
9
1

0
1
2

7
2
2

4
4
2

1
6
2

8
7
2

5
9
2

2
1
3

9
2
3

6
4
3

3
6
3

0
8
3

7
9
3

# of photos

Figure 3: The statistics of photo number owned
by users (users owned less than Ô¨Åve photos are re-
moved).

s
o
t
o
h
p
 
f
o
#

 

3500

3000

2500

2000

1500

1000

500

0

1

6
2

1
5

6
7

1
0
1

6
2
1

1
5
1

6
7
1

1
0
2

6
2
2

1
5
2

6
7
2

1
0
3

6
2
3

1
5
3

6
7
3

1
0
4

6
2
4

1
5
4

6
7
4

1
0
5

6
2
5

1
5
5

6
7
5

1
0
6

6
2
6

1
5
6

6
7
6

1
0
7

6
2
7

# of comments

Figure 4: The statistics of comment number given
by photos.

tity search in social media community, and report compara-
tive results on three popular entity search tasks, i.e., friend
suggestion, image tagging and personalized image search.

6.1 Dataset

We empirically verify the merit of entity search on a dataset
crawled from Flickr [4]. The data from Flickr consists of Ô¨Åve
main elements: users, uploaded photos, the tags associated
with each photo, geo-location of each photo, and users who
comment on the photo (called ‚Äúcmt users‚Äù for short). We
randomly collect 165,558 users and the corresponding pho-
tos, tags and comments by using Flickr API. For our experi-
ment, we remove the users who have less than 5 photos, and
then the dataset includes 40,170 users (not includes the cmt
users), owning about 9 million photos.

Fig.3 shows the number of photos owned by users. The
long tail indicates most of users share similar number of pho-
tos, and very few users own the extremely large number of
photos. In average, a user owns around 200 photos in our
experiment. Fig.4 shows the number of comments on pho-
tos. The long tail phenomenon also exists, which indicates
although the social interaction is complex, the comments on
each photo are not too many (13 comments per photo in av-
erage). Fig.5 illustrates the tag frequency, where the noise
(misspelling words, combination of words and aÔ¨Éx varia-
tion) and some special words form the long tail.

6.2 Exp-I: Friend Suggestion

Friend suggestion aims to search a list of users, which have
similar interests to the given user. Obviously, the entity type
of both query and searching pool is ‚Äúuser.‚Äù Therefore, in this
task, the user similarity is mainly explored and a ranking list
of users can be obtained according to Eq.(19). We compare

y
c
n
e
u
q
e
r
f
g
a
t

350000

300000

250000

200000

150000

100000

50000

0

1

6
9

1
9
1

6
8
2

1
8
3

6
7
4

1
7
5

6
6
6

1
6
7

6
5
8

1
5
9

6
4
0
1

1
4
1
1

6
3
2
1

1
3
3
1

6
2
4
1

1
2
5
1

6
1
6
1

1
1
7
1

6
0
8
1

1
0
9
1

6
9
9
1

1
9
0
2

6
8
1
2

1
8
2
2

6
7
3
2

1
7
4
2

6
6
5
2

1
6
6
2

6
5
7
2

tag ID

Figure 5: The tag frequency distribution.

our uniÔ¨Åed framework based friend suggestion (UFS) with
the following Ô¨Åve methods in both subjective and objective
experiments:

‚Ä¢ Initial user similarity (IUS). The friends are ranked
based on the initial user similarities, which are directly
determined by user interaction in photo sharing activ-
ities as mentioned in Section 5.1.

‚Ä¢ Tag correlations (Tag). A tag correlation measured by
the number of common tags on the users‚Äô photos. The
higher the number of common tags, the more likely to
be friends of the two users.

‚Ä¢ Visual relationships (Visual). A visual relationship es-
timated according to the visual similarity of represen-
tative photos of users.

‚Ä¢ Fusion of user, tag and visual similarity (Fusion). A

linear fusion of IUS, Tag and Visual.

‚Ä¢ Context-based friend suggestion (Context) [22]. It aim-

s to leverage multiple contexts, including user-contributed
photos, their associated tags and geo-locations, as well
as user behaviors like viewing and commenting.

6.2.1

Subjective User Study

To evaluate the proposed friend suggestion strategy, we
randomly selected 1,000 users as the query users. The simi-
larity of each user pair was manually labeled by three sub-
jects on a scale of 1-3: (1) dissimilar (totally diÔ¨Äerent in-
terest), (2) similar (somewhat relevant interest), and (3)
strongly similar (almost same interest). The ground truth
similar degree of each pair is the median scale of three e-
valuations. Considering the pairs with high similarity have
especially important for most of applications, we adopted
the Normalized Discounted Cumulative Gain (NDCG) as
the performance metric. The NDCG score at the depth d in
the ranked lists is deÔ¨Åned by:

N DCG@d = ZdXd

j=1

‚àí 1

2rj
log(1 + j)

(29)

where rj is the rating of the j-th pair, Zd is a normalization
constant and is chosen so that a perfect ranking‚Äôs N DCG@d
value is 1. After computing the NDCG measure of each
query user, we average them to obtain an overall perfor-
mance evaluation on friend suggestion.

Fig.6 shows the experimental results. Overall, the results
across diÔ¨Äerent depth of NDCG consistently indicate that
UFS achieves a performance boost compared to IUS, Tag

1463	











	

 

 

 

 

 

 



          

!#&$

!#&

!#%$

!#%

!#"$

! "
!#"

!#!$

!

'()

*+,

-./0+1

20/.34

5346786

(2)

Figure 6: Subjective evaluation on friend suggestion.

Figure 8: Objective evaluation on friend suggestion.

9:5;<" 9:5;<% 9:5;<& 9:5;<= 9:5;<$ 9:5;<> 9:5;<? 9:5;<@ 9:5;<A 9:5;<"!

User Id

Representative photos

s
r
e
s
u
y
r
e
u
Q

t
s
i
l

d
n
e
i
r
f
d
e
t
s
e
g
g
u
S

8519617@N03

8789171@N07

11771426@N03

14307969@N03

21362899@N08

21512060@N06

Figure 7: The representative photos of suggested
friends for the user Id ‚Äú8519617@N03.‚Äù

and Visual which using single entity. Furthermore, in con-
trast to the linear fusion and context-based method, the
superiority of UFS demonstrates that allowing entity inter-
action can lead to better performance gain. As indicated by
our results, the friend suggestion based on our uniÔ¨Åed entity
search framework can better express the user relationship
by reinforcing the mutual exchange of information across
multiple entities over an integrated graph model.

Fig.7 shows the top Ô¨Åve users‚Äô representative photos to a
query user according to the Ô¨Ånal user intra-relations. From
the representative photos of each user, we can see that these
photos are similar with each other. These users are likely to
have similar interest and thus are potential candidates for
friend suggestion.

6.2.2 Objective Evaluation of Friend Suggestion

The objective evaluation was conducted according to the
contacts function in Flickr site, which is organized by users
themselves. If a user exists in the other user‚Äôs contact list,
we view the two users as friends. We Ô¨Årst Ô¨Åltered out the
users who have no contacts in Flickr site or in our user set.
After Ô¨Åltering, we obtained 2,975 users and took them as
the query users. Similar to the subjective user study, the
objective comparison as shown in Fig.8 also indicates the
strong performance of our proposed UFS in comparison to
others.

6.3 Exp-II: Image Tagging

Image tagging is to assign a set of tags to a given image
to describe the image content. In our uniÔ¨Åed entity search
framework, the query type is ‚Äúimage‚Äù and the type of entities
to be searched is ‚Äútag.‚Äù By exploring the aÔ¨Énity matrix Wt,
and link matrix Œ†p‚àºt, the tag ranking list can be obtained
by Eq.(19).

We compare our uniÔ¨Åed framework based image tagging

(UIT) with the following two baseline methods.

‚Ä¢ Initial image tags in Flickr site (IIT): The tags origi-

nally provided by the image owners.

‚Ä¢ Tagging ranking (TR). A Random walk is performed
over a tag similarity graph to estimate the relevance
score of tags for a given image [10].

To demonstrate the eÔ¨Äectiveness of the image tagging
methods, we randomly select 200 images from our collected
Flickr image dataset to perform image tagging. We also in-
vite people to label the tags on a 1-3 scales: (1) ‚Äúirrelevant,‚Äù
(2) ‚Äúrelevant,‚Äù and (3) ‚Äúexcellent,‚Äù and adopt NDCG as the
performance metric. After computing the NDCG score of
each image‚Äôs tag list, we average them to obtain an overall
performance evaluation of the image tagging method. Fig.9
shows the experimental results. We can see our proposed u-
niÔ¨Åed solution achieves much better performance compared
to the other baseline algorithms at diÔ¨Äerent depths of ND-
CG. The improvements demonstrate that UIT can facilitate
the relationship and interaction of diÔ¨Äerent entities through
mutual reinforcement and all the relationships can be re-
Ô¨Åned.

Fig.10 further illustrates some exemplary images with the
top Ô¨Åve tags generated by three image tagging methods.
We can clearly see that our recommended tags can better
characterize the image content.

6.4 Exp-III: Personalized Image Search

Given the large and growing importance of search engines,
personalized search has the potential to signiÔ¨Åcantly improve
searching experience [15]. Compared with the common im-
age search, in personalized image search, the user-speciÔ¨Åc
information is considered to distinguish the exact intention-
s of textual queries and rank the images. Formally in our
framework, the query types are ‚Äúuser‚Äù and ‚Äútextual tags,‚Äù
while the entities in searching pool are ‚Äúimages.‚Äù To obtain
the image ranking list, we estimate the aÔ¨Énity matrix based
on the photo aÔ¨Énity matrix Wp, and link matrixes Œ†u‚àºp
and Œ†p‚àºt. According to Eq.(19), we can obtain the image
ranking list.

1464IIT

TR

UIT

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

Figure 9: Performance comparison of image tagging
methods.

IIT: lion, Panthera leo,
Masai Mara, grass,
NikonflickrAward
TR: grass, animal,
mountain, yellow, cloud
UIT: lion, wildlife,
mammal, grass, Africa

IIT: Baja, wildwife,
seaofcortez, mexico,
mammal
TR: fish, water, mexico,
nature, texture
UIT: dolphin, whale,
mammal, sea, wildlife

IIT: ABigFave, amazing
photo, america, best
sunset, canon
TR: building, cloud,
sunset, nature, autumn
UIT: sunset, sky, sea,
landscape, nature

IIT: 091211, St. Paul,
Minnesota, parks, Como
Park
TR: green, tree, garden,
outdoor, football
UIT: tree, grass, sky,
mountain, outdoor

IIT: helo, helicopter
TR: helicopter, garden,
spring, landmark, bird
UIT: helicopter, rescue,
flying, sky, tree

IIT: 2012, 50D, Dingo,
Heal, Healesville
TR: raining, bird, flower,
nature, beautiful
UIT: bird, tree, nature,
wild, woodland

IIT: Ferrari, Fxx, spa,
francorchamps
TR: car, road, sand,
wildlife, landscape
UIT: car, Ferrari, racecar,
road, sports

IIT: Nikon, NikonD90,
D90, nature, Arun
TR: flower, color, tree,
plant, yellow
UIT: bee, flower, nature,
yellow, leaf

Figure 10: Example results of image tagging.

We select the following three state-of-the-art models as
the baselines and compare them with our uniÔ¨Åed framework
based method (UPIS).

‚Ä¢ Non-personalized (Non). Use the common text-based

image search mainly based on tf-idf functions [16].

‚Ä¢ Topic-based (Topic). It aims to explore folksonomy for

personalized search [19].

‚Ä¢ Preference-based (Pref). Perform personalized image
search by predicting user interests-based preference [12].

Similar to [12], we use comment-based evaluation approach,
where the images attract comments from user u are treated
as relevant when u issues queries. We build two test sce-
narios for the comment-based evaluation: 1) 50 randomly
selected users who gave comments to 10-30 photos, denot-
ed as Dataset 10-30, and 2) 20 users who gave comments
to more than 100 photos, denoted as Dataset 100. 15 tags
frequently appearing in the tags of commented images are
selected as the test queries. The metric of mMAP [15] is uti-
lized to evaluate the performance and the results are demon-
strated in Fig.12. From the results, we have the follow-
ing observations. (1) Our proposed uniÔ¨Åed solution achieves
better performance compared to the other three baseline al-
gorithms. This clearly demonstrates the eÔ¨Äectiveness of our
proposed uniÔ¨Åed solution in the personalized image search
task. (2) All mMAP values are not very high. This phe-
nomenon reÔ¨Çects the problem of comment-based evaluation

0.03

0.025

0.02

0.015

0.01

0.005

0

Non

Topic

Pref

UPIS

Dataset_10-30

Dataset_100

Figure 12: Performance comparison of personalized
image search for diÔ¨Äerent methods.

scheme: the commented images are considered relevant for
all the test queries. As no query information is involved, for
those queries non-relevant with the topic of the comment-
ed images, the performance tends to be low. (3) Compar-
ing between the two test scenarios, the average performance
of Data 100 also improves over Data 10-30. One possible
reason for the improvement is that those users having more
comments are active users who are likely to also attend more
interest groups and tag more images.

Fig.11 displays exemplary search results for the query
‚Äúsunrise.‚Äù The top eight non-personalized results and the
personalized results of three users (User A, User B and Us-
er C) are shown. We can see that by simultaneously con-
sidering query relevance and user information, the uniÔ¨Åed
framework based personalized image search could capture
the user‚Äôs preference under certain topics. From the results,
we can see that the top search results for user A mainly focus
on sunrise at the seaside, while for user B and user C, the
top search results are often co-exist with cloud and plants.
For the baseline method (non-personalized) which separate
query relevance and user preference, most of the search re-
sults are relevant to query, yet may hard to interpret a clear
search intent.

6.5 Complexity Analysis

The complexity of our approach includes oÔ¨Ñine and on-
line two parts. The oÔ¨Ñine multi-level graph construction on
40,170 users with their photos, tags and comments can be
Ô¨Ånished in ten hours on Ô¨Åve servers, each having 4GB mem-
ories and running four threads. Our online entity search
algorithm is extremely eÔ¨Écient. The complexity of the al-
gorithm is O(|V | lg |V | + |E|), where |V | and |E| represent
the number of vertices and edges, respectively. Take 200 im-
ages to perform image tagging for example, our algorithm
takes less than 60.2 seconds on a regular PC (Intel dual-
core 3.33GHz CPU and 4 GB RAM) to complete the whole
process. In other words, tagging one image only takes 0.3
seconds. It can be even faster if executed on a more power-
ful machine with parallel computing capability. Clearly, the
speed is eÔ¨Écient and provides almost instant response.

7. CONCLUSIONS

In this paper, we have shown how to integrate various enti-
ties in a multi-level graph model, which includes the content
from images, tags and geo-locations, as well as the rich con-
text derived from user behaviors. SpeciÔ¨Åcally, the relations
between users, images and tags are fully exploited by rein-
forcing the mutual exchange and propagation of information
relevancy across diÔ¨Äerent entities. Upon the model, entity

1465Figure 11: Example of non-personalized (top) and personalized (second, third and fourth for User A, User
B and User C respectively) search results for query ‚Äúsunrise.‚Äù

search is explicitly formulated within a uniÔ¨Åed framework,
in which friend suggestion, image tagging and personalized
image search can be implemented in one single way. Fu-
ture work includes the extension to multiple media sharing
sites, such as Facebook and LinkedIn. It would be a promis-
ing topic to investigate whether these entities are consistent
across diÔ¨Äerent social media sharing sites and whether spe-
ciÔ¨Åc factors may impact the way users create, share, use and
annotate content.

8. ACKNOWLEDGMENTS

This work was supported in part by a grant from the
RGC of the Hong Kong SAR, China (CityU 119610), a
grant from the National Natural Science Foundation of Chi-
na (#61272290), and a grant from Microsoft Research Asia
Windows Phone Academic Program (FY12-RES-OPP-107).

9. REFERENCES
[1] H. M. Chen, M. H. Chang, P. C. Chang, M. C. Tien, W. H.

Hsu, and J. L. Wu. Sheepdog-group and tag
recommendation for Ô¨Çickr photos by automatic
search-based learning. In Proceedings of ACM Multimedia,
2008.

[2] R. L. Cilibrasi and P. M. Vitanyi. The google similarity

distance. IEEE Trans. on Knowledge and Data
Engineering, 19(3):370‚Äì383, 2007.

[3] D. Easley and J. Kleinberg. Networks and Crowds and
Markets: Reasoning About a Highly Connected World.
Cambridge University Press, 2010.

[4] Flickr. http://www.Ô¨Çickr.com/.
[5] ImageClef. http://imageclef.org/.
[6] Y. Jing and S. Baluja. Pagerank for product image search.

In Proceedings of International WWW Conference, 2008.
[7] J. Li and J. Z. Wang. Real-time computerized annotation

of pictures. IEEE Trans. on Pattern Analysis and Machine
Intelligence, 2008.

[8] Q. Li, Y. Zheng, X. Xie, Y. Chen, W. Liu, and W.-Y. Ma.

Mining user similarity based on location history. In
Proceedings of ACM GIS, 2008.

[9] Y.-R. Lin, J. Sun, P. Castro, R. Konuru, H. Sundaram, and

A. Kelliher. Metafac: Community discovery via relational
hypergraph factorization. In Proceedings of ACM KDD,
2009.

[10] D. Liu, X.-S. Hua, L. Yang, M. Wang, and H.-J. Zhang.

Tag ranking. In Proceedings of International WWW
Conference, 2009.

[11] D. Lowe. Object recognition with informative features and

linear classiÔ¨Åcation. In Proceedings of ICCV, 2003.

[12] D. Lu and Q. Li. Personalized search on Ô¨Çickr based on

searcher‚Äôs preference prediction. In Proceedings of
International WWW Conference, 2011.

[13] R.-A. Negoescu, B. Adams, D. Phung, S. Venkatesh, and

D. Gatica-Perez. Flickr hypergroups. In Proceedings of
ACM Multimedia, 2009.

[14] M. Roth, A. David, D. Deutscher, G. Flysher, I. Horn,

A. Leichtberg, N. Leiser, Y. Matias, and R. Merom.
Suggesting friends using the implicit social graph. In
Proceedings of ACM KDD, 2010.

[15] J. Sang, C. Xu, and D. Lu. Learn to personalized image
search from the photo sharing websites. IEEE Trans. on
Multimedia, 14(4), 2012.

[16] J. Sivic and A. Zisserman. Video google: A text retrieval
approach to object matching in videos. In Proceedings of
IEEE International Conference on Computer Vision, 2003.
[17] M. Sniedovich. Dijkstra‚Äôs algorithm revisited: the dynamic

programming connexion. Control and Cybernetics, 35(3),
2006.

[18] C. Wilson, A. Sala, K. P. N. Puttaswamy, and B. Y. Zhao.

Beyond social graphs: User interactions in online social
networks and their implications. ACM Trans. on the Web,
2012.

[19] S. Xu, S. Bao, B. Fei, Z. Su, and Y. Yu. Exploring

folksonomy for personalized search. In Proceedings of ACM
SIGIR, 2008.

[20] Yahoo. http://people.yahoo.com/.
[21] T. Yao, T. Mei, and C.-W. Ngo. Co-reranking by mutual

reinforcement for image search. In ACM CIVR, 2010.
[22] T. Yao, C.-W. Ngo, and T. Mei. Context-based friend

suggestion in online photo-sharing community. In
Proceedings of ACM Multimedia, 2011.

[23] T. Yao, C.-W. Ngo, and T. Mei. Circular reranking for
visual search. IEEE Trans. on Image Processing, 22(4),
April 2013.

[24] N. Zheng, Q. Li, S. Liao, and L. Zhang. Flickr group

recommendation based on tensor decomposition. In
Proceedings of ACM SIGIR, 2010.

[25] D. Zhou, O. Bousquet, T. Lal, J. Weston, and B. Sch¬®olkopf.

Learning with local and global consistency. In Proceedings
of NIPS, 2003.

[26] J. Zhuang, T. Mei, S. Hoi, X.-S. Hua, and S. Li. Modeling
social strength in social media community via kernel-based
learning. In Proceedings of ACM Multimedia, 2011.

1466